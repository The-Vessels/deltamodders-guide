import{_ as i,o as a,c as n,ah as h}from"./chunks/framework.DgwX6g3i.js";const g=JSON.parse(`{"title":"GameMaker's Data File","description":"","frontmatter":{},"headers":[],"relativePath":"gamemaker/data-file.md","filePath":"gamemaker/data-file.md"}`),e={name:"gamemaker/data-file.md"};function l(p,s,t,k,r,d){return a(),n("div",null,[...s[0]||(s[0]=[h(`<h1 id="gamemaker-s-data-file" tabindex="-1">GameMaker&#39;s Data File <a class="header-anchor" href="#gamemaker-s-data-file" aria-label="Permalink to “GameMaker&#39;s Data File”">​</a></h1><p>On Windows, it&#39;s called <code>data.win</code>. On macOS, it&#39;s called <code>game.ios</code>. It&#39;s the same file, just with a different name.</p><h1 id="endianess" tabindex="-1">Endianess <a class="header-anchor" href="#endianess" aria-label="Permalink to “Endianess”">​</a></h1><p>I am pretty sure every number in a GameMaker data file is little-endian.</p><h1 id="chunk-header" tabindex="-1">Chunk Header <a class="header-anchor" href="#chunk-header" aria-label="Permalink to “Chunk Header”">​</a></h1><p>This is important because it is used for every single chunk in GameMaker. It has 8 bytes:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 |</span></span>
<span class="line"><span>|---|---|---|---|---|---|---|---|</span></span>
<span class="line"><span>| Chunk Name    | Chunk Size    |</span></span></code></pre></div><p>The chunk name is a &quot;string&quot; that is four characters long. It will always have all-caps letters or numbers in it, like <code>GEN8</code> or <code>TXTR</code>.</p><p>The chunk size is a 4-byte (32-bit) little-endian unsigned integer that specifies the number of bytes of the chunk that will come AFTER the header.</p><h1 id="file-structure" tabindex="-1">File Structure <a class="header-anchor" href="#file-structure" aria-label="Permalink to “File Structure”">​</a></h1><p>GameMaker data files will ALWAYS start with the FORM chunk, which contains all other chunks. This means that the file will ALWAYS start with <code>FORM</code>, followed by a 32-bit little-endian unsigned integer specifying the filesize minus 8 bytes (because the header is 8 bytes).</p><h1 id="example-code-to-traverse-through-the-chunks" tabindex="-1">Example code to traverse through the chunks <a class="header-anchor" href="#example-code-to-traverse-through-the-chunks" aria-label="Permalink to “Example code to traverse through the chunks”">​</a></h1><div class="language-gml"><button title="Copy Code" class="copy"></button><span class="lang">gml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> struct</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> os</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> get_chunk_info</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(header: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bytes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) -&gt; tuple[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">str</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # &#39;&lt;&#39; means little-endian</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # &#39;4s&#39; means a 4-byte string</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # &#39;I&#39; means a 32-bit unsigned integer</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    format</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;&lt;4sI&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    name, size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> struct.unpack(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, header)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # &#39;.decode&#39; converts &#39;name&#39; from bytes to str</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> name.decode(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;utf-8&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), size</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">with</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;game.ios&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;rb&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    form_name, form_size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> get_chunk_info(f.read(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # the first chunk is ALWAYS form</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    assert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> form_name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;FORM&#39;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;FORM chunk size: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">form_size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    n_chunks </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    while</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> True</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        header </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> f.read(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(header) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            # we reached the end of the file</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            break</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # the header is ALWAYS 8 bytes</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        assert</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(header) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        chunk_name, chunk_size </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> get_chunk_info(header)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Found chunk </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">chunk_name</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, which is </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">chunk_size</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bytes long&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        n_chunks </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # go forward &#39;chunk_size&#39; bytes</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        f.seek(chunk_size, os.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">SEEK_CUR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Found </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">n_chunks</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> chunks.&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>This is the output when <code>game.ios</code> is DELTARUNE Chapter 4 for macOS&#39;s data file:</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>FORM chunk size: 131798966 bytes</span></span>
<span class="line"><span>Found chunk GEN8, which is 1504 bytes long</span></span>
<span class="line"><span>Found chunk OPTN, which is 88 bytes long</span></span>
<span class="line"><span>Found chunk LANG, which is 24 bytes long</span></span>
<span class="line"><span>Found chunk EXTN, which is 56 bytes long</span></span>
<span class="line"><span>Found chunk SOND, which is 23656 bytes long</span></span>
<span class="line"><span>Found chunk AGRP, which is 24 bytes long</span></span>
<span class="line"><span>Found chunk SPRT, which is 1134200 bytes long</span></span>
<span class="line"><span>Found chunk BGND, which is 52744 bytes long</span></span>
<span class="line"><span>Found chunk PATH, which is 1176 bytes long</span></span>
<span class="line"><span>Found chunk SCPT, which is 35032 bytes long</span></span>
<span class="line"><span>Found chunk GLOB, which is 3832 bytes long</span></span>
<span class="line"><span>Found chunk SHDR, which is 4584 bytes long</span></span>
<span class="line"><span>Found chunk FONT, which is 392376 bytes long</span></span>
<span class="line"><span>Found chunk TMLN, which is 8 bytes long</span></span>
<span class="line"><span>Found chunk OBJT, which is 698840 bytes long</span></span>
<span class="line"><span>Found chunk FEDS, which is 24 bytes long</span></span>
<span class="line"><span>Found chunk ACRV, which is 328 bytes long</span></span>
<span class="line"><span>Found chunk SEQN, which is 8 bytes long</span></span>
<span class="line"><span>Found chunk TAGS, which is 6296 bytes long</span></span>
<span class="line"><span>Found chunk ROOM, which is 13829304 bytes long</span></span>
<span class="line"><span>Found chunk DAFL, which is 8 bytes long</span></span>
<span class="line"><span>Found chunk EMBI, which is 136 bytes long</span></span>
<span class="line"><span>Found chunk TPAG, which is 528952 bytes long</span></span>
<span class="line"><span>Found chunk TGIN, which is 24456 bytes long</span></span>
<span class="line"><span>Found chunk CODE, which is 7807896 bytes long</span></span>
<span class="line"><span>Found chunk VARI, which is 635176 bytes long</span></span>
<span class="line"><span>Found chunk FUNC, which is 271720 bytes long</span></span>
<span class="line"><span>Found chunk FEAT, which is 24 bytes long</span></span>
<span class="line"><span>Found chunk STRG, which is 3081688 bytes long</span></span>
<span class="line"><span>Found chunk TXTR, which is 10218184 bytes long</span></span>
<span class="line"><span>Found chunk AUDO, which is 93046374 bytes long</span></span>
<span class="line"><span>Found 31 chunks.</span></span></code></pre></div>`,15)])])}const E=i(e,[["render",l]]);export{g as __pageData,E as default};
